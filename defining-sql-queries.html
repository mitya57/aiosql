

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Defining SQL Queries &mdash; aiosql 3.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Topics" href="advanced-topics.html" />
    <link rel="prev" title="Getting Started" href="getting-started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> aiosql
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Defining SQL Queries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#query-names">Query Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-comments">Query Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operators">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#no-operator-default">No Operator (Default)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-one"><code class="docutils literal notranslate"><span class="pre">^</span></code> Select One</a></li>
<li class="toctree-l3"><a class="reference internal" href="#select-value"><code class="docutils literal notranslate"><span class="pre">$</span></code> Select Value</a></li>
<li class="toctree-l3"><a class="reference internal" href="#insert-update-delete"><code class="docutils literal notranslate"><span class="pre">!</span></code> Insert/Update/Delete</a></li>
<li class="toctree-l3"><a class="reference internal" href="#insert-update-delete-returning"><code class="docutils literal notranslate"><span class="pre">&lt;!</span></code> Insert/Update/Delete Returning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#insert-update-delete-many"><code class="docutils literal notranslate"><span class="pre">*!</span></code> Insert/Update/Delete Many</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execute-scripts"><code class="docutils literal notranslate"><span class="pre">#</span></code> Execute Scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced-topics.html">Advanced Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="database-driver-adapters.html">Database Driver Adapters</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="pydoc/modules.html">API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">aiosql</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Defining SQL Queries</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/defining-sql-queries.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="defining-sql-queries">
<h1>Defining SQL Queries<a class="headerlink" href="#defining-sql-queries" title="Permalink to this headline">¶</a></h1>
<div class="section" id="query-names">
<h2>Query Names<a class="headerlink" href="#query-names" title="Permalink to this headline">¶</a></h2>
<p>Name definitions are how aiosql determines the name of the methods that SQL code blocks are accessible by. A query name is defined by a SQL comment of the form “– name: “.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: get_all_blogs</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">blogs</span><span class="p">;</span>
</pre></div>
</div>
<p>This query will be available in aiosql under the python method name <code class="docutils literal notranslate"><span class="pre">.get_all_blogs(conn)</span></code></p>
</div>
<div class="section" id="query-comments">
<h2>Query Comments<a class="headerlink" href="#query-comments" title="Permalink to this headline">¶</a></h2>
<p><em>./sql/blogs.sql</em></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: get_all_blogs</span>
<span class="c1">-- Fetch all fields for every blog in the database.</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">blogs</span><span class="p">;</span>
</pre></div>
</div>
<p>Any other SQL comments you make between the name definition and your code will be used a the python documentation string for the generated method. You can use <code class="docutils literal notranslate"><span class="pre">help()</span></code> in the Python REPL to view these comments while using python.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Python</span> <span class="mf">3.8.3</span> <span class="p">(</span><span class="n">default</span><span class="p">,</span> <span class="n">May</span> <span class="mi">17</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">42</span><span class="p">)</span>
<span class="p">[</span><span class="n">GCC</span> <span class="mf">10.1.0</span><span class="p">]</span> <span class="n">on</span> <span class="n">linux</span>
<span class="n">Type</span> <span class="s2">&quot;help&quot;</span><span class="p">,</span> <span class="s2">&quot;copyright&quot;</span><span class="p">,</span> <span class="s2">&quot;credits&quot;</span> <span class="ow">or</span> <span class="s2">&quot;license&quot;</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span><span class="o">.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">aiosql</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">queries</span> <span class="o">=</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s2">&quot;sql&quot;</span><span class="p">,</span> <span class="s2">&quot;sqlite3&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="n">queries</span><span class="o">.</span><span class="n">get_all_blogs</span><span class="p">)</span>
<span class="n">Help</span> <span class="n">on</span> <span class="n">method</span> <span class="n">get_all_blogs</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">queries</span><span class="p">:</span>

<span class="n">get_all_blogs</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="n">method</span> <span class="n">of</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">queries</span><span class="o">.</span><span class="n">Queries</span> <span class="n">instance</span>
    <span class="n">Fetch</span> <span class="nb">all</span> <span class="n">fields</span> <span class="k">for</span> <span class="n">every</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">database</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h2>
<p>This section describes the usage of various query operator symbols that you can annotate query names with in order to direct how aiosql will execute and return results.</p>
<div class="section" id="no-operator-default">
<h3>No Operator (Default)<a class="headerlink" href="#no-operator-default" title="Permalink to this headline">¶</a></h3>
<p>In the above <a class="reference external" href="#query-names">Query Names</a> section the <code class="docutils literal notranslate"><span class="pre">get-all-blogs</span></code> name is written without any trailing operators.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: get_all_blogs</span>
</pre></div>
</div>
<p>The lack of an operator is actually the most basic operator used by default for your queries. This tells aiosql to execute the query and to return all the results. In the case of <code class="docutils literal notranslate"><span class="pre">get-all-blogs</span></code> that means a <code class="docutils literal notranslate"><span class="pre">select</span></code> statement will be executed and a list of rows will be returned. When writing your application you will often need to perform other operations besides <code class="docutils literal notranslate"><span class="pre">select</span></code>, like <code class="docutils literal notranslate"><span class="pre">insert</span></code>, <code class="docutils literal notranslate"><span class="pre">delete</span></code>, and perhaps bulk operations. The operators detailed in the other sections of this doc let you declare in your SQL code how that query should be executed by a python database driver.</p>
</div>
<div class="section" id="select-one">
<h3><code class="docutils literal notranslate"><span class="pre">^</span></code> Select One<a class="headerlink" href="#select-one" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">^</span></code> operator executes a query and returns the first row of a result set. When there are no rows in the result set it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. This is useful when you know there should be one, and exactly one result from your query.</p>
<p>As an example, if you have a unique constraint on the <code class="docutils literal notranslate"><span class="pre">username</span></code> field in your <code class="docutils literal notranslate"><span class="pre">users</span></code> table which makes it impossible for two users to share the same username, you could use <code class="docutils literal notranslate"><span class="pre">^</span></code> to direct aiosql to select a single user rather than a list of rows of length 1.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: get_user_by_username^</span>
<span class="k">select</span> <span class="n">userid</span><span class="p">,</span>
       <span class="n">username</span><span class="p">,</span>
       <span class="n">name</span>
  <span class="k">from</span> <span class="n">users</span>
 <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="p">:</span><span class="n">username</span><span class="p">;</span>
</pre></div>
</div>
<p>When used from Python this query will either return <code class="docutils literal notranslate"><span class="pre">None</span></code> or the singular selected row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span><span class="o">.</span><span class="n">get_user_by_username</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s2">&quot;willvaughn&quot;</span><span class="p">)</span>
<span class="c1"># =&gt; (1, &quot;willvaughn&quot;, &quot;William Vaughn&quot;) or None</span>
</pre></div>
</div>
</div>
<div class="section" id="select-value">
<h3><code class="docutils literal notranslate"><span class="pre">$</span></code> Select Value<a class="headerlink" href="#select-value" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">$</span></code> operator will execute the query, and only return the first value of the first row of a result set. If there are no rows in the result set it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>. This is implemented by returing the first element of the tuple returned by <code class="docutils literal notranslate"><span class="pre">cur.fetchone()</span></code> of the underlying driver. This is mostly useful for queries returning IDs, COUNTs or other aggregates.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: get-count$</span>
<span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">users</span>
</pre></div>
</div>
<p>When used from Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span><span class="o">.</span><span class="n">get_count</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
<span class="c1"># =&gt; 3</span>
</pre></div>
</div>
</div>
<div class="section" id="insert-update-delete">
<h3><code class="docutils literal notranslate"><span class="pre">!</span></code> Insert/Update/Delete<a class="headerlink" href="#insert-update-delete" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">!</span></code> operator executes SQL without returning any results. It is meant for statements that use <code class="docutils literal notranslate"><span class="pre">insert</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, and <code class="docutils literal notranslate"><span class="pre">delete</span></code> to make modifications to database rows without a necessary return value.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: publish_blog!</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">blogs</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span> <span class="k">values</span> <span class="p">(:</span><span class="n">userid</span><span class="p">,</span> <span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="p">:</span><span class="n">content</span><span class="p">);</span>

<span class="c1">-- name: remove_blog!</span>
<span class="c1">-- Remove a blog from the database</span>
<span class="k">delete</span> <span class="k">from</span> <span class="n">blogs</span> <span class="k">where</span> <span class="n">blogid</span> <span class="o">=</span> <span class="p">:</span><span class="n">blogid</span><span class="p">;</span>
</pre></div>
</div>
<p>The methods generated are:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>publish_blog(conn, userid: int, title: str, content: str) -&gt; None:
remove_blog(conn, blogid: int) -&gt; None:
</pre></div>
</div>
<p>Each can be called to alter the database, but both will return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<div class="section" id="insert-update-delete-returning">
<h3><code class="docutils literal notranslate"><span class="pre">&lt;!</span></code> Insert/Update/Delete Returning<a class="headerlink" href="#insert-update-delete-returning" title="Permalink to this headline">¶</a></h3>
<p>When performing a modification of rows, or adding new rows, sometimes it is necessary to return values using the <code class="docutils literal notranslate"><span class="pre">returning</span></code> clause where available. With the <code class="docutils literal notranslate"><span class="pre">&lt;!</span></code> operator aiosql can execute a query and return values.</p>
<p>When using SQLite this operator will return the id of the inserted row using <code class="docutils literal notranslate"><span class="pre">`cur.lastrowid</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.lastrowid">https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.lastrowid</a>&gt;`__.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: publish_blog&lt;!</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">blogs</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span> <span class="k">values</span> <span class="p">(:</span><span class="n">userid</span><span class="p">,</span> <span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="p">:</span><span class="n">content</span><span class="p">);</span>
</pre></div>
</div>
<p>Executing this query in python will return the <code class="docutils literal notranslate"><span class="pre">blogid</span></code> of the inserted row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s2">&quot;blogs.sql&quot;</span><span class="p">,</span> <span class="s2">&quot;sqlite3&quot;</span><span class="p">)</span>
<span class="c1"># ... connection code ...</span>
<span class="n">blogid</span> <span class="o">=</span> <span class="n">queries</span><span class="o">.</span><span class="n">publish_blog</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">userid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hi&quot;</span> <span class="n">content</span><span class="o">=</span><span class="s2">&quot;blah blah.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>PostgreSQL allows returning multiple values via the <code class="docutils literal notranslate"><span class="pre">returning</span></code> clause of queries. This same query using <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> might look like the following.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: publish_blog&lt;!</span>
<span class="k">insert</span> <span class="k">into</span> <span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">content</span><span class="p">)</span>
     <span class="k">values</span> <span class="p">(:</span><span class="n">userid</span><span class="p">,</span> <span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="p">:</span><span class="n">content</span><span class="p">)</span>
  <span class="n">returning</span> <span class="n">blogid</span><span class="p">,</span> <span class="n">title</span><span class="p">;</span>
</pre></div>
</div>
<p>In python a tuple is returned with the <code class="docutils literal notranslate"><span class="pre">blogid</span></code> and <code class="docutils literal notranslate"><span class="pre">title</span></code> of the inserted row.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s2">&quot;blogs.sql&quot;</span><span class="p">,</span> <span class="s2">&quot;psycopg2&quot;</span><span class="p">)</span>
<span class="c1"># ... connection code ...</span>
<span class="n">blogid</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">queries</span><span class="o">.</span><span class="n">publish_blog</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">userid</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Hi&quot;</span> <span class="n">content</span><span class="o">=</span><span class="s2">&quot;blah blah.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="insert-update-delete-many">
<h3><code class="docutils literal notranslate"><span class="pre">*!</span></code> Insert/Update/Delete Many<a class="headerlink" href="#insert-update-delete-many" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">*!</span></code> operator directs aiosql to execute a SQL statement over all items of a given sequence. Under the hood this calls the <code class="docutils literal notranslate"><span class="pre">executemany</span></code> method of many database drivers. See <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.executemany">sqlite3 Cursor.executemany</a> for an example.</p>
<p>In aiosql we can use this for a bulk publish method that operates over a list of blog entries.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: bulk_publish*!</span>
<span class="c1">-- Insert many blogs at once</span>
<span class="k">insert</span> <span class="k">into</span> <span class="n">blogs</span> <span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">published</span><span class="p">)</span>
<span class="k">values</span> <span class="p">(:</span><span class="n">userid</span><span class="p">,</span> <span class="p">:</span><span class="n">title</span><span class="p">,</span> <span class="p">:</span><span class="n">content</span><span class="p">,</span> <span class="p">:</span><span class="n">published</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s2">&quot;blogs.sql&quot;</span><span class="p">,</span> <span class="s2">&quot;psycopg2&quot;</span><span class="p">)</span>
<span class="c1"># ... connection code ...</span>
<span class="n">blogs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;userid&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;First Blog&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">published</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)},</span>
    <span class="p">{</span><span class="s2">&quot;userid&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Next Blog&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">published</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)},</span>
    <span class="p">{</span><span class="s2">&quot;userid&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Hey, Hey!&quot;</span><span class="p">,</span> <span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span> <span class="n">published</span><span class="p">:</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">28</span><span class="p">)},</span>
<span class="p">]</span>
<span class="n">queries</span><span class="o">.</span><span class="n">bulk_publish</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">blogs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-scripts">
<h3><code class="docutils literal notranslate"><span class="pre">#</span></code> Execute Scripts<a class="headerlink" href="#execute-scripts" title="Permalink to this headline">¶</a></h3>
<p>Using this operarator will execute sql statements as a script. You can’t do variable substitution with the <code class="docutils literal notranslate"><span class="pre">#</span></code> operator. An example usecase is using data definition statements like create table in order to setup a database.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="c1">-- name: create_schema#</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">users</span> <span class="p">(</span>
    <span class="n">userid</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="n">username</span> <span class="nb">text</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">firstname</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">lastname</span> <span class="nb">text</span> <span class="k">not</span> <span class="k">null</span>
<span class="p">);</span>

<span class="k">create</span> <span class="k">table</span> <span class="n">blogs</span> <span class="p">(</span>
    <span class="n">blogid</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="n">userid</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">title</span> <span class="nb">text</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">content</span> <span class="nb">text</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
    <span class="n">published</span> <span class="nb">date</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span> <span class="k">CURRENT_DATE</span><span class="p">,</span>
    <span class="k">foreign</span> <span class="k">key</span><span class="p">(</span><span class="n">userid</span><span class="p">)</span> <span class="k">references</span> <span class="n">users</span><span class="p">(</span><span class="n">userid</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">queries</span> <span class="o">=</span> <span class="n">aiosql</span><span class="o">.</span><span class="n">from_path</span><span class="p">(</span><span class="s2">&quot;create_schema.sql&quot;</span><span class="p">,</span> <span class="s2">&quot;sqlite3&quot;</span><span class="p">)</span>
<span class="c1"># ... connection code ...</span>
<span class="n">queries</span><span class="o">.</span><span class="n">create_schema</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="advanced-topics.html" class="btn btn-neutral float-right" title="Advanced Topics" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="getting-started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, William Vaughn.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>